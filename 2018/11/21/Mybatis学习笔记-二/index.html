<!doctype html>
<html lang="en">
    <head>
		
        <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <link rel="shortcut icon" href="/asset/star.png"/>
        <link rel="canonical" href="http://guolinn.com/">
        <link rel="alternate" type="application/rss+xml" title="Homxu" href="/atom.xml">
        <title>Mybatis学习笔记-二 | Homxu</title>
        <meta name="description" content="{{meta_description}}">

        <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/styles/crisp.css">
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>
    
		<body class="post-template">
	

        <header id="header">
            <a id="logo" href="/"><img src="/asset/star.png" alt="Homxu" /></a>
            <h1><a href="/">Homxu</a></h1>
            <p>程序员也要好好生活</p>
            <div id="follow-icons">
          <a href="http://github.com/homxuwang"><i class="fa fa-github-square fa-2x"></i></a>
              <a href="/atom.xml"><i class="fa fa-rss-square fa-2x"></i></a>
  </div>
<h6><a href="/about">About</a></h6>
        </header>

        <main id="content">
        

<article class="post">
  November 21, 2018
  
    <span class="taglist">  &middot; 
    
    
      <a href='/tags/学习笔记/'>学习笔记</a> 
    
    </span>
  

  <h1 class="post-title">Mybatis学习笔记-二</h1>
  <section class="post-content article-entry">
    <h1 id="parameterType-输入类型"><a href="#parameterType-输入类型" class="headerlink" title="parameterType(输入类型)"></a>parameterType(输入类型)</h1><h2 id="传递简单类型和传递pojo对象"><a href="#传递简单类型和传递pojo对象" class="headerlink" title="传递简单类型和传递pojo对象"></a>传递简单类型和传递pojo对象</h2><p>简单类型：使用#{}占位符，或者${}进行sql拼接。</p>
<p>opjo对象：Mybatis使用ognl表达式解析对象字段的值，#{}或者${}括号中的值为pojo属性名称。</p>
<h2 id="传递pojo包装对象"><a href="#传递pojo包装对象" class="headerlink" title="传递pojo包装对象"></a>传递pojo包装对象</h2><p>开发中通过可以使用pojo传递查询条件。<br>查询条件可能是综合的查询条件，不仅包括用户查询条件还包括其它的查询条件（比如查询用户信息的时候，将用户购买商品信息也作为查询条件），这时可以使用包装对象传递输入参数。</p>
<p>包装对象：Pojo类中的一个属性是另外一个pojo。</p>
<p>需求：根据用户名模糊查询用户信息，查询条件放到QueryVo的user属性中。</p>
<p>在<code>Mybatis学习笔记-一</code>的基础上，继续编写<code>QueryVo</code>类进行开发:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> my.study.pojo;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</div><div class="line">	<span class="comment">//包含其他的pojo</span></div><div class="line">	<span class="keyword">private</span> User user;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> user;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.user = user;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在<code>my.study.mapper</code>包下的<code>User.xml</code>中书写sql语句:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 使用包装类型查询用户 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserByQueryVo"</span> <span class="attr">parameterType</span>=<span class="string">"my.study.pojo.QueryVo"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">		select * from user where username like "%"#&#123;user.username&#125;"%"</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>在<code>UserMapper.java</code>接口中添加方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> my.study.mapper;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> my.study.pojo.QueryVo;</div><div class="line"><span class="keyword">import</span> my.study.pojo.User;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(Integer id)</span></span>;</div><div class="line">	<span class="comment">//添加方法</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUserByQueryVo</span><span class="params">(QueryVo vo)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>书写测试代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testfindUserByQueryVo</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">//1.加载核心配置文件</span></div><div class="line">	String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">	InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">	<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">	SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">	<span class="comment">//3.创建SqlSession</span></div><div class="line">	SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">	<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">	UserMapper mapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">	</div><div class="line">	QueryVo vo =<span class="keyword">new</span> QueryVo();</div><div class="line">	User u = <span class="keyword">new</span> User();</div><div class="line">	u.setUsername(<span class="string">"五"</span>);</div><div class="line">	vo.setUser(u);</div><div class="line">	List&lt;User&gt; us = mapper.findUserByQueryVo(vo);</div><div class="line">	<span class="keyword">for</span>(User user:us) &#123;</div><div class="line">		System.out.println(user);</div><div class="line">	&#125;		</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/2018/11/21/Mybatis学习笔记-二/1.png" alt="结果"></p>
<h1 id="resultType-输出类型"><a href="#resultType-输出类型" class="headerlink" title="resultType(输出类型)"></a>resultType(输出类型)</h1><h2 id="输出简单类型"><a href="#输出简单类型" class="headerlink" title="输出简单类型"></a>输出简单类型</h2><p>需求：查询user的数量</p>
<p>在<code>UserMapper.java</code>接口中添加方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">  <span class="comment">//查询数据条数</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">findUserCount</span><span class="params">()</span></span>;</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>Mapper.xml中添加查询语句:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 查询用户条数 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserCount"</span> <span class="attr">resultType</span>=<span class="string">"Integer"</span>&gt;</span></div><div class="line">		select count(*) from user</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>书写测试类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查询用户条数</span></div><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testfindUserCount</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">//1.加载核心配置文件</span></div><div class="line">	String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">	InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">	<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">	SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">	<span class="comment">//3.创建SqlSession</span></div><div class="line">	SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">	<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">	UserMapper mapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">	</div><div class="line">	Integer count = mapper.findUserCount();</div><div class="line">	System.out.println(count);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/2018/11/21/Mybatis学习笔记-二/2.png" alt="结果"></p>
<h2 id="输出pojo对象和对象列表"><a href="#输出pojo对象和对象列表" class="headerlink" title="输出pojo对象和对象列表"></a>输出pojo对象和对象列表</h2><p>见 <a href="https://homxuwang.github.io/2018/11/19/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/" target="_blank" rel="external">https://homxuwang.github.io/2018/11/19/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/</a></p>
<h1 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap"></a>resultMap</h1><p>resultType可以指定将查询结果映射为pojo，但需要pojo的属性名和sql查询的列名一致方可映射成功。</p>
<p>如果sql查询字段名和pojo的属性名不一致，可以通过resultMap将字段名和属性名作一个对应关系 ，resultMap实质上还需要将查询结果映射到pojo对象中。</p>
<p>resultMap可以实现将查询结果映射为复杂类型的pojo，比如在查询结果映射对象中包括pojo和list实现一对一查询和一对多查询。</p>
<p>需求：查询订单表order的所有数据,订单表创建见:<a href="https://homxuwang.github.io/2018/11/19/Mybatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80/" target="_blank" rel="external">Mybatis学习笔记-一</a><br>sql：SELECT id, user_id, number, createtime, note FROM <code>order</code></p>
<p>创建POJO类:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> my.study.pojo;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span>  <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</div><div class="line">   </div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> Integer id;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> Integer userId;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> String number;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> Date createtime;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> String note;</div><div class="line">  </div><div class="line">  <span class="keyword">private</span> User user;</div><div class="line"></div><div class="line">  添加 get/set 方法</div><div class="line"></div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"Orders [id="</span> + id + <span class="string">", userId="</span> + userId + <span class="string">", number="</span> + number + <span class="string">", createtime="</span> + createtime</div><div class="line">        + <span class="string">", note="</span> + note + <span class="string">"]"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>可以看到类中<code>userId</code>字段和数据库表中的<code>user_id</code>字段名不一致<br><img src="/2018/11/21/Mybatis学习笔记-二/3.png" alt="user_id不同"></p>
<p>在<code>my.study.mapper</code>包中添加<code>OrderMapper</code>接口:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> my.study.mapper;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">import</span> my.study.pojo.Orders;</div><div class="line"><span class="keyword">import</span> my.study.pojo.User;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;	</div><div class="line">	<span class="comment">//	查询订单表order的所有数据</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;Orders&gt; <span class="title">selectOrdersList</span><span class="params">()</span></span>;	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>定义<code>OrderMapper.xml</code>:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper</span></div><div class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></div><div class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"my.study.mapper.OrderMapper"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 查询所有的订单数据 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectOrdersList"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.Orders"</span>&gt;</span></div><div class="line">		SELECT id, user_id,</div><div class="line">		number,</div><div class="line">		createtime, note FROM orders</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>记得在核心配置文件中引入<code>OrderMapper.xml</code>：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"my/study/mapper/User.xml"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"my/study/mapper/OrderMapper.xml"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>书写测试类:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查询订单表的所有数据</span></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testfindUserCount</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">//1.加载核心配置文件</span></div><div class="line">		String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">		InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">		<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">		<span class="comment">//3.创建SqlSession</span></div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">		<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">		OrderMapper mapper =  sqlSession.getMapper(OrderMapper.class);</div><div class="line">		</div><div class="line">		List&lt;Orders&gt; orderlist = mapper.selectOrdersList();</div><div class="line">		<span class="keyword">for</span>(Orders order:orderlist) &#123;</div><div class="line">			System.out.println(order);</div><div class="line">		&#125;		</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/2018/11/21/Mybatis学习笔记-二/4.png" alt="测试结果"><br>可以看到，对于POJO类中和数据库表中字段不一致的，将会查询出null.<br>除了修改为一样的字段值外，可以使用<code>resultMap</code>:<br><img src="/2018/11/21/Mybatis学习笔记-二/5.png" alt="测试结果"><br>其实，与数据库字段不一样的只有<code>user_id</code>和<code>userId</code>，没有必要都写出来，所以可以简写为:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"my.study.pojo.Orders"</span> <span class="attr">id</span>=<span class="string">"orders"</span>&gt;</span>		</div><div class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"userId"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><code>column</code>对应数据库表字段;<code>property</code>对应POJO字段;<code>javaType</code>对应java类型(可以省略);<code>jdbcType</code>对应数据库中的类型(可以省略)</p>
<p>再次执行测试代码:<br><img src="/2018/11/21/Mybatis学习笔记-二/6.png" alt="测试结果"></p>
<h1 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h1><p>通过mybatis提供的各种标签方法实现动态拼接sql</p>
<h2 id="if标签"><a href="#if标签" class="headerlink" title="if标签"></a>if标签</h2><p>需求：根据性别和名字查询用户<br>查询sql：<br>SELECT id, username, birthday, sex, address FROM <code>user</code> WHERE sex = 1 AND username LIKE ‘%张%’</p>
<p>在<code>UserMapper.java</code>接口中添加方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment">//根据性别和名称查询用户</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUserBySexAndUsername</span><span class="params">(User user)</span></span>;</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>在<code>User.xml</code>中书写sql语句:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 使用if和where标签 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserBySexAndUsername"</span> <span class="attr">parameterType</span>=<span class="string">"my.study.pojo.User"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">		select * from user </div><div class="line">		where</div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null and sex != ''"</span>&gt;</span></div><div class="line">			sex = #&#123;sex&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null and username != ''"</span>&gt;</span></div><div class="line">			and username = #&#123;username&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>书写测试类:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查询用户条数</span></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testselectUserBySexAndUsername</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">//1.加载核心配置文件</span></div><div class="line">		String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">		InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">		<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">		<span class="comment">//3.创建SqlSession</span></div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">		<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">		UserMapper mapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">		User u = <span class="keyword">new</span> User();</div><div class="line">		u.setSex(<span class="string">"1"</span>);</div><div class="line">		u.setUsername(<span class="string">"张小明"</span>);</div><div class="line">		List&lt;User&gt; users = mapper.selectUserBySexAndUsername(u);</div><div class="line">		<span class="keyword">for</span>(User user:users) &#123;</div><div class="line">			System.out.println(user);</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>查询结果：<br><img src="/2018/11/21/Mybatis学习笔记-二/7.png" alt="测试结果"></p>
<p>因为通过user实例查询的sex和username字段都不为空，所以可以看到sql语句是正常的.</p>
<p>如果注释掉<code>u.setUsername(&quot;张小明&quot;);</code>再进行测试 :<br><img src="/2018/11/21/Mybatis学习笔记-二/8.png" alt="测试结果"><br>可以看到查询出的是sex为1的所有数据，因为username=null，所以在if标签中没有添加后面的<code>and username = #{username}</code></p>
<p>但是如果注释掉<code>u.setSex(&quot;1&quot;);</code>，将<code>u.setUsername(&quot;张小明&quot;);</code>还原，再次进行测试：<br><img src="/2018/11/21/Mybatis学习笔记-二/9.png" alt="测试结果"><br><img src="/2018/11/21/Mybatis学习笔记-二/10.png" alt="测试结果"><br>可以看到，查询错误，sql语句是拼接错误的.<br>这时候就需要用到<code>where</code>标签</p>
<h2 id="where标签"><a href="#where标签" class="headerlink" title="where标签"></a>where标签</h2><p>where标签可以自动添加where，同时处理sql语句中第一个<code>前</code>and关键字<br>对上面的查询语句做处理:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserBySexAndUsername"</span> <span class="attr">parameterType</span>=<span class="string">"my.study.pojo.User"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">	select * from user </div><div class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null and sex != ''"</span>&gt;</span></div><div class="line">		sex = #&#123;sex&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null and username != ''"</span>&gt;</span></div><div class="line">			and username = #&#123;username&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span>		</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>再次进行测试：<br><img src="/2018/11/21/Mybatis学习笔记-二/11.png" alt="测试结果"><br>上面提到where标签可以处理sql语句中第一个<code>前</code>and关键字</p>
<h2 id="SQL片段"><a href="#SQL片段" class="headerlink" title="SQL片段"></a>SQL片段</h2><p>Sql中可将重复的sql提取出来，使用时用include引用即可，最终达到sql重用的目的。<br>先定义一个用于共用的sql片段,然后使用include进行引用:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"selectFromUser"</span>&gt;</span></div><div class="line">	select * from user</div><div class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!--使用sql片段--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserBySexAndUsername"</span> <span class="attr">parameterType</span>=<span class="string">"my.study.pojo.User"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"selectFromUser"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null and sex != ''"</span>&gt;</span></div><div class="line">		sex = #&#123;sex&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null and username != ''"</span>&gt;</span></div><div class="line">			and username = #&#123;username&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span>		</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="foreach标签"><a href="#foreach标签" class="headerlink" title="foreach标签"></a>foreach标签</h2><p>需求：根据多个id查询用户信息<br>在<code>UserMapper</code>接口中添加方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//根据多个id查询用户信息</span></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUserByIds</span><span class="params">(QueryVo vo)</span></span>;</div></pre></td></tr></table></figure></p>
<p>在<code>QueryVo</code>中改造：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> List&lt;Integer&gt; idsList;</div><div class="line"><span class="comment">//添加get/set方法</span></div></pre></td></tr></table></figure></p>
<p>书写sql：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserByIds"</span> <span class="attr">parameterType</span>=<span class="string">"my.study.pojo.QueryVo"</span> <span class="attr">resultType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"selectFromUser"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">		id in</div><div class="line">		<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"idsList"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></div><div class="line">			#&#123;id&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>collection：遍历的集合，这里是QueryVo的idsList属性<br>item：遍历的项目，可以随便写，但是和后面的#{}里面要一致<br>open：在前面添加的sql片段<br>close：在结尾处添加的sql片段<br>separator：指定遍历的元素之间使用的分隔符<br><code>注意</code>:如果接口的方法参数处传递的是数组类型的参数，则需要将collection处值设置为<code>array</code>;同理，如果接口的方法参数处传递的是list类型的参数，则需要将collection处值设置为<code>list</code><br>测试:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//多个id</span></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testselectUserByidsList</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">//1.加载核心配置文件</span></div><div class="line">		String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">		InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">		<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">		<span class="comment">//3.创建SqlSession</span></div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">		<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">		UserMapper mapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">		List&lt;Integer&gt; ids = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">		ids.add(<span class="number">16</span>);</div><div class="line">		ids.add(<span class="number">22</span>);</div><div class="line">		ids.add(<span class="number">24</span>);</div><div class="line">		QueryVo vo = <span class="keyword">new</span> QueryVo();</div><div class="line">		vo.setIdsList(ids);</div><div class="line">		List&lt;User&gt; users = mapper.selectUserByIds(vo);</div><div class="line">		<span class="keyword">for</span>(User user:users) &#123;</div><div class="line">			System.out.println(user);</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>测试结果:<br><img src="/2018/11/21/Mybatis学习笔记-二/12.png" alt="测试结果"></p>
<h1 id="关联查询"><a href="#关联查询" class="headerlink" title="关联查询"></a>关联查询</h1><p><img src="/2018/11/21/Mybatis学习笔记-二/13.png" alt="测试结果"></p>
<h2 id="一对一关联查询"><a href="#一对一关联查询" class="headerlink" title="一对一关联查询"></a>一对一关联查询</h2><p>改造<code>UserMapper</code>,在接口中添加方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//一对一关联 查询  以订单为中心 关联用户</span></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;Orders&gt; <span class="title">selectOrders</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure></p>
<p>在<code>User.xml</code>中书写sql(需要用到嵌套映射):<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"my.study.pojo.Orders"</span> <span class="attr">id</span>=<span class="string">"orderUserResultMap"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"userId"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"createtime"</span> <span class="attr">property</span>=<span class="string">"createtime"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"note"</span>  <span class="attr">property</span>=<span class="string">"note"</span>/&gt;</span></div><div class="line">		<span class="comment">&lt;!-- association ：配置一对一属性 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- property:order里面的User属性名 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- javaType:属性类型 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">javaType</span>=<span class="string">"my.study.pojo.User"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- id:声明主键，表示user_id是关联查询对象的唯一标识--&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectOrders"</span> <span class="attr">resultMap</span>=<span class="string">"orderUserResultMap"</span>&gt;</span></div><div class="line">		select </div><div class="line">		o.id,</div><div class="line">		o.user_id,</div><div class="line">		o.number,</div><div class="line">		o.createtime,</div><div class="line">		o.note,</div><div class="line">		u.username </div><div class="line">		from orders o </div><div class="line">		LEFT JOIN user u </div><div class="line">		on o.user_id = u.id</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>测试:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//一对一</span></div><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testselectOrders</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">//1.加载核心配置文件</span></div><div class="line">	String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">	InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">	<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">	SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">	<span class="comment">//3.创建SqlSession</span></div><div class="line">	SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">	<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">	UserMapper mapper =  sqlSession.getMapper(UserMapper.class);</div><div class="line">	</div><div class="line">	List&lt;Orders&gt; orderlist = mapper.selectOrders();</div><div class="line">	<span class="keyword">for</span>(Orders order:orderlist) &#123;</div><div class="line">		System.out.println(order);</div><div class="line">		System.out.println(order.getUser());</div><div class="line">	&#125;		</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>查询结果:<br><img src="/2018/11/21/Mybatis学习笔记-二/15.png" alt="测试结果"><br><img src="/2018/11/21/Mybatis学习笔记-二/14.png" alt="测试结果"></p>
<h2 id="一对多关联查询"><a href="#一对多关联查询" class="headerlink" title="一对多关联查询"></a>一对多关联查询</h2><p>一个用户有可能对应多个订单，所以以user表作为左表进行查询，是一对多的关系。</p>
<p><img src="/2018/11/21/Mybatis学习笔记-二/16.png" alt="查询结果"></p>
<p>在<code>User</code>类中添加订单列表属性字段,并添加get和set方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="keyword">private</span> List&lt;Orders&gt; ordersList;</div><div class="line"><span class="comment">//get/set</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p><code>OrderMapper</code>接口中添加方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//一对多关联</span></div><div class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">selectUserList</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure></p>
<p>在<code>OrderMapper.xml</code>中书写sql代码:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"my.study.pojo.User"</span> <span class="attr">id</span>=<span class="string">"userResultMap"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span>/&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 配置一对多属性  </span></div><div class="line"><span class="comment">			ofType是指List中每个元素的类型</span></div><div class="line"><span class="comment">		--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"ordersList"</span> <span class="attr">ofType</span>=<span class="string">"my.study.pojo.Orders"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"userId"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"createtime"</span> <span class="attr">property</span>=<span class="string">"createtime"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"note"</span> <span class="attr">property</span>=<span class="string">"note"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line">	</div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserList"</span> <span class="attr">resultMap</span>=<span class="string">"userResultMap"</span>&gt;</span></div><div class="line">		select </div><div class="line">		o.id,</div><div class="line">		o.user_id,</div><div class="line">		o.number,</div><div class="line">		o.createtime,</div><div class="line">		o.note,</div><div class="line">		u.username </div><div class="line">		from  user u </div><div class="line">		LEFT JOIN orders o</div><div class="line">		on o.user_id = u.id</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>测试代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//一对多</span></div><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testselectUserList</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">//1.加载核心配置文件</span></div><div class="line">	String resource = <span class="string">"sqlMapConfig.xml"</span>;</div><div class="line">	InputStream in = Resources.getResourceAsStream(resource);</div><div class="line">	<span class="comment">//2.创建SqlSessionFactory</span></div><div class="line">	SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</div><div class="line">	<span class="comment">//3.创建SqlSession</span></div><div class="line">	SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">	<span class="comment">//4.SqlSession根据接口生成一个实现类</span></div><div class="line">	OrderMapper mapper =  sqlSession.getMapper(OrderMapper.class);</div><div class="line">	</div><div class="line">	List&lt;User&gt; userlist = mapper.selectUserList();</div><div class="line">	<span class="keyword">for</span>(User user:userlist) &#123;</div><div class="line">		System.out.println(user);</div><div class="line">		System.out.println(user.getOrdersList());</div><div class="line">	&#125;		</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/2018/11/21/Mybatis学习笔记-二/17.png" alt="测试结果"></p>

  </section>
  <footer class="post-footer">
    <!--
    <section class="author">
      <h4>Homxu</h4>
      <p></p>
    </section>
    -->
  </footer>
</article>

<nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/2018/11/29/Spring与Mybatis整合/">
        ← prev <!--Spring与Mybatis整合-->
    </a>
    
    <span class="page-number">•</span>
    
    <a class="older-posts" href="/2018/11/19/Mybatis学习笔记-一/">
        <!--Mybatis学习笔记-一--> next →
    </a>
    
</nav>


        </main>
        <footer id="footer">
            <section id="footer-message">&copy; 2019 Homxu. All rights reserved. Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. <a href="https://github.com/guolin/crisp-hexo-theme" target="_blank">crisp</a> theme by <a href="guolin.github.io" target="_blank">Guo Lin</a>.</section>
        </footer>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','/js/ga.js','ga');
            ga('create', 'UA-141265597-1', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>


